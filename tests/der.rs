use tls_pki_types::{DerObject, PrivatePkcs1KeyDer, PrivatePkcs8KeyDer, PrivateSec1KeyDer};

#[test]
fn ec() {
    let pkcs8_real = PrivatePkcs8KeyDer::from_der_slice(&PKCS8_EC).unwrap();
    let ec = PrivateSec1KeyDer::try_from(pkcs8_real.clone()).unwrap();

    let ec_real = PrivateSec1KeyDer::from_der_slice(&EC).unwrap();
    let pkcs8 = PrivatePkcs8KeyDer::try_from(ec.clone()).unwrap();

    assert_eq!(ec, ec_real);
    assert_eq!(pkcs8, pkcs8_real);
}

#[test]
fn rsa() {
    let pkcs8_real = PrivatePkcs8KeyDer::from_der_slice(&PKCS8_RSA).unwrap();
    let rsa = PrivatePkcs1KeyDer::try_from(pkcs8_real.clone()).unwrap();

    let rsa_real = PrivatePkcs1KeyDer::from_der_slice(&RSA).unwrap();
    let pkcs8 = PrivatePkcs8KeyDer::try_from(rsa_real.clone()).unwrap();

    assert_eq!(rsa, rsa_real);
    assert_eq!(pkcs8, pkcs8_real);
}

const EC: [u8; 121] = [
    48, 119, 2, 1, 1, 4, 32, 44, 206, 128, 9, 126, 72, 59, 150, 96, 24, 197, 214, 234, 166, 81, 20,
    61, 109, 224, 253, 62, 188, 217, 46, 136, 103, 239, 151, 158, 210, 160, 43, 160, 10, 6, 8, 42,
    134, 72, 206, 61, 3, 1, 7, 161, 68, 3, 66, 0, 4, 47, 43, 97, 73, 133, 36, 95, 250, 185, 93, 1,
    171, 129, 174, 61, 154, 109, 105, 177, 7, 14, 144, 111, 180, 230, 90, 245, 193, 210, 172, 94,
    95, 246, 68, 92, 230, 69, 212, 68, 211, 67, 18, 48, 9, 239, 180, 35, 248, 165, 150, 63, 84, 18,
    129, 129, 205, 138, 241, 53, 241, 232, 98, 204, 102,
];

const PKCS8_EC: [u8; 138] = [
    48, 129, 135, 2, 1, 0, 48, 19, 6, 7, 42, 134, 72, 206, 61, 2, 1, 6, 8, 42, 134, 72, 206, 61, 3,
    1, 7, 4, 109, 48, 107, 2, 1, 1, 4, 32, 44, 206, 128, 9, 126, 72, 59, 150, 96, 24, 197, 214,
    234, 166, 81, 20, 61, 109, 224, 253, 62, 188, 217, 46, 136, 103, 239, 151, 158, 210, 160, 43,
    161, 68, 3, 66, 0, 4, 47, 43, 97, 73, 133, 36, 95, 250, 185, 93, 1, 171, 129, 174, 61, 154,
    109, 105, 177, 7, 14, 144, 111, 180, 230, 90, 245, 193, 210, 172, 94, 95, 246, 68, 92, 230, 69,
    212, 68, 211, 67, 18, 48, 9, 239, 180, 35, 248, 165, 150, 63, 84, 18, 129, 129, 205, 138, 241,
    53, 241, 232, 98, 204, 102,
];

const RSA: [u8; 1191] = [
    48, 130, 4, 163, 2, 1, 0, 2, 130, 1, 1, 0, 212, 159, 210, 177, 25, 229, 223, 214, 230, 248,
    105, 28, 119, 245, 219, 183, 5, 246, 76, 63, 12, 152, 161, 169, 216, 49, 198, 121, 154, 226,
    34, 43, 205, 221, 195, 80, 186, 182, 247, 210, 5, 176, 46, 168, 153, 44, 197, 165, 133, 85,
    226, 219, 225, 43, 241, 191, 84, 37, 222, 68, 192, 149, 193, 105, 91, 101, 218, 179, 66, 223,
    154, 245, 3, 11, 111, 39, 239, 29, 122, 92, 205, 145, 38, 1, 39, 254, 195, 20, 146, 134, 201,
    113, 192, 147, 73, 89, 33, 94, 254, 137, 196, 28, 234, 128, 41, 131, 32, 68, 96, 149, 116, 217,
    234, 210, 62, 229, 9, 50, 253, 254, 135, 123, 225, 248, 159, 179, 82, 60, 38, 111, 121, 142,
    221, 218, 248, 135, 166, 186, 124, 169, 189, 12, 39, 59, 33, 99, 1, 67, 237, 185, 35, 255, 86,
    147, 94, 6, 47, 233, 107, 139, 239, 242, 138, 196, 190, 153, 180, 252, 95, 185, 197, 160, 32,
    131, 169, 158, 92, 224, 27, 166, 67, 156, 8, 194, 132, 8, 187, 104, 206, 238, 243, 180, 248,
    163, 196, 0, 97, 139, 192, 111, 97, 63, 213, 94, 249, 47, 157, 157, 116, 185, 224, 115, 7, 11,
    230, 120, 204, 195, 165, 48, 51, 30, 221, 222, 228, 199, 0, 195, 246, 219, 6, 68, 242, 165,
    106, 31, 199, 145, 90, 187, 51, 43, 5, 122, 9, 174, 134, 222, 220, 177, 242, 246, 99, 234, 97,
    155, 2, 3, 1, 0, 1, 2, 130, 1, 0, 19, 79, 218, 226, 164, 16, 9, 119, 42, 238, 88, 25, 178, 89,
    157, 213, 175, 80, 114, 23, 109, 236, 245, 14, 8, 169, 104, 182, 5, 215, 209, 51, 186, 84, 144,
    151, 102, 6, 21, 87, 57, 150, 9, 126, 221, 190, 191, 202, 235, 99, 228, 33, 133, 127, 168, 202,
    240, 121, 42, 9, 131, 150, 118, 133, 59, 188, 114, 19, 67, 25, 45, 41, 96, 215, 234, 134, 45,
    133, 55, 102, 115, 115, 98, 8, 203, 217, 171, 93, 84, 123, 178, 147, 70, 226, 249, 208, 3, 36,
    110, 41, 20, 43, 110, 47, 42, 214, 18, 153, 179, 78, 15, 217, 117, 39, 24, 120, 84, 16, 18, 26,
    202, 178, 121, 81, 76, 44, 12, 229, 104, 55, 48, 15, 85, 217, 220, 243, 45, 15, 79, 231, 17,
    156, 203, 162, 213, 250, 207, 93, 252, 139, 38, 35, 43, 116, 147, 169, 34, 121, 82, 13, 77,
    119, 81, 74, 84, 248, 198, 94, 238, 143, 12, 66, 11, 155, 202, 221, 11, 30, 52, 197, 52, 85,
    89, 51, 94, 182, 53, 122, 205, 203, 144, 52, 178, 178, 78, 173, 129, 254, 108, 46, 172, 73,
    198, 245, 30, 138, 220, 88, 141, 67, 89, 34, 243, 211, 146, 231, 238, 249, 43, 124, 159, 217,
    108, 12, 185, 55, 137, 111, 36, 20, 109, 215, 242, 8, 30, 252, 37, 97, 182, 81, 200, 214, 28,
    82, 178, 50, 207, 59, 112, 57, 66, 18, 35, 243, 69, 21, 2, 129, 129, 0, 251, 36, 56, 44, 189,
    212, 49, 25, 30, 205, 177, 187, 184, 31, 80, 105, 128, 91, 83, 230, 113, 50, 150, 172, 119,
    156, 181, 176, 37, 167, 252, 151, 41, 216, 36, 52, 75, 120, 223, 132, 133, 60, 214, 118, 46,
    170, 118, 233, 223, 179, 226, 89, 81, 14, 68, 245, 168, 221, 56, 96, 58, 152, 199, 102, 73, 84,
    223, 173, 246, 197, 164, 36, 235, 227, 210, 99, 111, 189, 127, 163, 51, 61, 121, 219, 123, 39,
    23, 171, 171, 138, 19, 48, 95, 147, 113, 83, 62, 36, 7, 103, 78, 87, 201, 221, 73, 174, 50,
    179, 140, 223, 161, 24, 39, 59, 119, 147, 155, 131, 168, 78, 163, 112, 180, 65, 169, 77, 97,
    253, 2, 129, 129, 0, 216, 188, 216, 207, 121, 126, 138, 125, 44, 170, 17, 152, 122, 54, 34, 85,
    112, 224, 145, 156, 225, 254, 191, 204, 230, 84, 32, 235, 68, 224, 82, 122, 233, 142, 174, 80,
    179, 173, 104, 210, 192, 136, 185, 223, 189, 220, 26, 45, 48, 117, 114, 195, 15, 231, 99, 232,
    10, 88, 108, 176, 213, 66, 248, 104, 115, 69, 28, 248, 101, 80, 161, 1, 188, 16, 183, 146, 241,
    139, 160, 8, 240, 36, 105, 150, 236, 168, 161, 126, 50, 3, 197, 36, 198, 202, 127, 145, 229,
    161, 129, 93, 72, 0, 105, 90, 79, 201, 155, 81, 30, 119, 85, 148, 183, 242, 131, 210, 192, 239,
    56, 178, 23, 250, 250, 232, 218, 74, 185, 119, 2, 129, 128, 96, 171, 217, 127, 199, 118, 133,
    139, 192, 226, 182, 214, 166, 146, 79, 54, 189, 52, 234, 127, 218, 244, 249, 48, 220, 62, 19,
    102, 1, 168, 191, 63, 68, 217, 49, 94, 123, 234, 196, 71, 83, 174, 78, 115, 97, 149, 54, 126,
    226, 32, 113, 49, 166, 84, 210, 208, 169, 54, 182, 123, 188, 50, 145, 22, 219, 133, 115, 48,
    152, 188, 13, 106, 52, 239, 22, 78, 54, 118, 0, 74, 198, 239, 148, 23, 155, 57, 58, 16, 87,
    208, 167, 128, 72, 90, 14, 22, 87, 230, 48, 127, 96, 149, 196, 91, 141, 0, 35, 254, 31, 108,
    249, 170, 189, 119, 83, 153, 27, 20, 187, 213, 193, 110, 33, 196, 224, 177, 171, 213, 2, 129,
    129, 0, 211, 75, 80, 6, 252, 71, 220, 21, 106, 60, 166, 136, 194, 228, 17, 150, 192, 67, 126,
    81, 182, 148, 215, 65, 151, 110, 126, 229, 62, 49, 126, 215, 106, 232, 121, 146, 29, 136, 185,
    255, 116, 74, 23, 3, 68, 33, 214, 183, 37, 93, 234, 178, 181, 199, 124, 67, 148, 10, 94, 116,
    10, 132, 142, 141, 173, 138, 188, 82, 128, 219, 25, 12, 10, 223, 53, 72, 33, 9, 96, 204, 53,
    233, 25, 179, 84, 38, 149, 193, 228, 90, 126, 144, 122, 232, 161, 115, 135, 173, 106, 227, 152,
    181, 38, 0, 48, 118, 184, 95, 93, 215, 50, 236, 152, 99, 234, 21, 197, 151, 177, 235, 21, 171,
    205, 126, 194, 137, 68, 195, 2, 129, 128, 95, 159, 40, 78, 140, 11, 119, 80, 162, 221, 110,
    252, 244, 154, 212, 190, 147, 91, 166, 102, 131, 84, 140, 32, 53, 210, 160, 131, 221, 20, 54,
    208, 165, 137, 252, 190, 108, 42, 4, 249, 124, 238, 195, 125, 213, 196, 221, 69, 211, 93, 103,
    105, 56, 211, 60, 75, 236, 155, 164, 68, 147, 70, 125, 148, 116, 52, 146, 181, 58, 100, 246,
    85, 103, 250, 183, 167, 238, 56, 248, 43, 28, 144, 40, 208, 9, 146, 58, 181, 93, 142, 203, 133,
    247, 152, 189, 144, 209, 235, 157, 144, 222, 222, 115, 128, 7, 166, 102, 174, 99, 2, 247, 221,
    247, 193, 11, 27, 181, 71, 216, 9, 141, 101, 212, 61, 205, 144, 75, 50,
];

const PKCS8_RSA: [u8; 1217] = [
    48, 130, 4, 189, 2, 1, 0, 48, 13, 6, 9, 42, 134, 72, 134, 247, 13, 1, 1, 1, 5, 0, 4, 130, 4,
    167, 48, 130, 4, 163, 2, 1, 0, 2, 130, 1, 1, 0, 212, 159, 210, 177, 25, 229, 223, 214, 230,
    248, 105, 28, 119, 245, 219, 183, 5, 246, 76, 63, 12, 152, 161, 169, 216, 49, 198, 121, 154,
    226, 34, 43, 205, 221, 195, 80, 186, 182, 247, 210, 5, 176, 46, 168, 153, 44, 197, 165, 133,
    85, 226, 219, 225, 43, 241, 191, 84, 37, 222, 68, 192, 149, 193, 105, 91, 101, 218, 179, 66,
    223, 154, 245, 3, 11, 111, 39, 239, 29, 122, 92, 205, 145, 38, 1, 39, 254, 195, 20, 146, 134,
    201, 113, 192, 147, 73, 89, 33, 94, 254, 137, 196, 28, 234, 128, 41, 131, 32, 68, 96, 149, 116,
    217, 234, 210, 62, 229, 9, 50, 253, 254, 135, 123, 225, 248, 159, 179, 82, 60, 38, 111, 121,
    142, 221, 218, 248, 135, 166, 186, 124, 169, 189, 12, 39, 59, 33, 99, 1, 67, 237, 185, 35, 255,
    86, 147, 94, 6, 47, 233, 107, 139, 239, 242, 138, 196, 190, 153, 180, 252, 95, 185, 197, 160,
    32, 131, 169, 158, 92, 224, 27, 166, 67, 156, 8, 194, 132, 8, 187, 104, 206, 238, 243, 180,
    248, 163, 196, 0, 97, 139, 192, 111, 97, 63, 213, 94, 249, 47, 157, 157, 116, 185, 224, 115, 7,
    11, 230, 120, 204, 195, 165, 48, 51, 30, 221, 222, 228, 199, 0, 195, 246, 219, 6, 68, 242, 165,
    106, 31, 199, 145, 90, 187, 51, 43, 5, 122, 9, 174, 134, 222, 220, 177, 242, 246, 99, 234, 97,
    155, 2, 3, 1, 0, 1, 2, 130, 1, 0, 19, 79, 218, 226, 164, 16, 9, 119, 42, 238, 88, 25, 178, 89,
    157, 213, 175, 80, 114, 23, 109, 236, 245, 14, 8, 169, 104, 182, 5, 215, 209, 51, 186, 84, 144,
    151, 102, 6, 21, 87, 57, 150, 9, 126, 221, 190, 191, 202, 235, 99, 228, 33, 133, 127, 168, 202,
    240, 121, 42, 9, 131, 150, 118, 133, 59, 188, 114, 19, 67, 25, 45, 41, 96, 215, 234, 134, 45,
    133, 55, 102, 115, 115, 98, 8, 203, 217, 171, 93, 84, 123, 178, 147, 70, 226, 249, 208, 3, 36,
    110, 41, 20, 43, 110, 47, 42, 214, 18, 153, 179, 78, 15, 217, 117, 39, 24, 120, 84, 16, 18, 26,
    202, 178, 121, 81, 76, 44, 12, 229, 104, 55, 48, 15, 85, 217, 220, 243, 45, 15, 79, 231, 17,
    156, 203, 162, 213, 250, 207, 93, 252, 139, 38, 35, 43, 116, 147, 169, 34, 121, 82, 13, 77,
    119, 81, 74, 84, 248, 198, 94, 238, 143, 12, 66, 11, 155, 202, 221, 11, 30, 52, 197, 52, 85,
    89, 51, 94, 182, 53, 122, 205, 203, 144, 52, 178, 178, 78, 173, 129, 254, 108, 46, 172, 73,
    198, 245, 30, 138, 220, 88, 141, 67, 89, 34, 243, 211, 146, 231, 238, 249, 43, 124, 159, 217,
    108, 12, 185, 55, 137, 111, 36, 20, 109, 215, 242, 8, 30, 252, 37, 97, 182, 81, 200, 214, 28,
    82, 178, 50, 207, 59, 112, 57, 66, 18, 35, 243, 69, 21, 2, 129, 129, 0, 251, 36, 56, 44, 189,
    212, 49, 25, 30, 205, 177, 187, 184, 31, 80, 105, 128, 91, 83, 230, 113, 50, 150, 172, 119,
    156, 181, 176, 37, 167, 252, 151, 41, 216, 36, 52, 75, 120, 223, 132, 133, 60, 214, 118, 46,
    170, 118, 233, 223, 179, 226, 89, 81, 14, 68, 245, 168, 221, 56, 96, 58, 152, 199, 102, 73, 84,
    223, 173, 246, 197, 164, 36, 235, 227, 210, 99, 111, 189, 127, 163, 51, 61, 121, 219, 123, 39,
    23, 171, 171, 138, 19, 48, 95, 147, 113, 83, 62, 36, 7, 103, 78, 87, 201, 221, 73, 174, 50,
    179, 140, 223, 161, 24, 39, 59, 119, 147, 155, 131, 168, 78, 163, 112, 180, 65, 169, 77, 97,
    253, 2, 129, 129, 0, 216, 188, 216, 207, 121, 126, 138, 125, 44, 170, 17, 152, 122, 54, 34, 85,
    112, 224, 145, 156, 225, 254, 191, 204, 230, 84, 32, 235, 68, 224, 82, 122, 233, 142, 174, 80,
    179, 173, 104, 210, 192, 136, 185, 223, 189, 220, 26, 45, 48, 117, 114, 195, 15, 231, 99, 232,
    10, 88, 108, 176, 213, 66, 248, 104, 115, 69, 28, 248, 101, 80, 161, 1, 188, 16, 183, 146, 241,
    139, 160, 8, 240, 36, 105, 150, 236, 168, 161, 126, 50, 3, 197, 36, 198, 202, 127, 145, 229,
    161, 129, 93, 72, 0, 105, 90, 79, 201, 155, 81, 30, 119, 85, 148, 183, 242, 131, 210, 192, 239,
    56, 178, 23, 250, 250, 232, 218, 74, 185, 119, 2, 129, 128, 96, 171, 217, 127, 199, 118, 133,
    139, 192, 226, 182, 214, 166, 146, 79, 54, 189, 52, 234, 127, 218, 244, 249, 48, 220, 62, 19,
    102, 1, 168, 191, 63, 68, 217, 49, 94, 123, 234, 196, 71, 83, 174, 78, 115, 97, 149, 54, 126,
    226, 32, 113, 49, 166, 84, 210, 208, 169, 54, 182, 123, 188, 50, 145, 22, 219, 133, 115, 48,
    152, 188, 13, 106, 52, 239, 22, 78, 54, 118, 0, 74, 198, 239, 148, 23, 155, 57, 58, 16, 87,
    208, 167, 128, 72, 90, 14, 22, 87, 230, 48, 127, 96, 149, 196, 91, 141, 0, 35, 254, 31, 108,
    249, 170, 189, 119, 83, 153, 27, 20, 187, 213, 193, 110, 33, 196, 224, 177, 171, 213, 2, 129,
    129, 0, 211, 75, 80, 6, 252, 71, 220, 21, 106, 60, 166, 136, 194, 228, 17, 150, 192, 67, 126,
    81, 182, 148, 215, 65, 151, 110, 126, 229, 62, 49, 126, 215, 106, 232, 121, 146, 29, 136, 185,
    255, 116, 74, 23, 3, 68, 33, 214, 183, 37, 93, 234, 178, 181, 199, 124, 67, 148, 10, 94, 116,
    10, 132, 142, 141, 173, 138, 188, 82, 128, 219, 25, 12, 10, 223, 53, 72, 33, 9, 96, 204, 53,
    233, 25, 179, 84, 38, 149, 193, 228, 90, 126, 144, 122, 232, 161, 115, 135, 173, 106, 227, 152,
    181, 38, 0, 48, 118, 184, 95, 93, 215, 50, 236, 152, 99, 234, 21, 197, 151, 177, 235, 21, 171,
    205, 126, 194, 137, 68, 195, 2, 129, 128, 95, 159, 40, 78, 140, 11, 119, 80, 162, 221, 110,
    252, 244, 154, 212, 190, 147, 91, 166, 102, 131, 84, 140, 32, 53, 210, 160, 131, 221, 20, 54,
    208, 165, 137, 252, 190, 108, 42, 4, 249, 124, 238, 195, 125, 213, 196, 221, 69, 211, 93, 103,
    105, 56, 211, 60, 75, 236, 155, 164, 68, 147, 70, 125, 148, 116, 52, 146, 181, 58, 100, 246,
    85, 103, 250, 183, 167, 238, 56, 248, 43, 28, 144, 40, 208, 9, 146, 58, 181, 93, 142, 203, 133,
    247, 152, 189, 144, 209, 235, 157, 144, 222, 222, 115, 128, 7, 166, 102, 174, 99, 2, 247, 221,
    247, 193, 11, 27, 181, 71, 216, 9, 141, 101, 212, 61, 205, 144, 75, 50,
];
